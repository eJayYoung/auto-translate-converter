{"version":3,"sources":["../../../lib/utils/shared-strings.js"],"names":["SharedStrings","module","exports","_values","_totalRefs","_hash","prototype","count","length","values","totalRefs","getString","index","add","value","undefined","push"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,gBAAgBC,OAAOC,OAAP,GAAiB,YAAW;AAC9C,OAAKC,OAAL,GAAe,EAAf;AACA,OAAKC,UAAL,GAAkB,CAAlB;AACA,OAAKC,KAAL,GAAa,EAAb;AACD,CAJD;;AAMAL,cAAcM,SAAd,GAA0B;AACxB,MAAIC,KAAJ,GAAY;AACV,WAAO,KAAKJ,OAAL,CAAaK,MAApB;AACD,GAHuB;AAIxB,MAAIC,MAAJ,GAAa;AACX,WAAO,KAAKN,OAAZ;AACD,GANuB;AAOxB,MAAIO,SAAJ,GAAgB;AACd,WAAO,KAAKN,UAAZ;AACD,GATuB;;AAWxBO,aAAW,mBAASC,KAAT,EAAgB;AACzB,WAAO,KAAKT,OAAL,CAAaS,KAAb,CAAP;AACD,GAbuB;;AAexBC,OAAK,aAASC,KAAT,EAAgB;AACnB,QAAIF,QAAQ,KAAKP,KAAL,CAAWS,KAAX,CAAZ;AACA,QAAIF,UAAUG,SAAd,EAAyB;AACvBH,cAAQ,KAAKP,KAAL,CAAWS,KAAX,IAAoB,KAAKX,OAAL,CAAaK,MAAzC;AACA,WAAKL,OAAL,CAAaa,IAAb,CAAkBF,KAAlB;AACD;AACD,SAAKV,UAAL;AACA,WAAOQ,KAAP;AACD;AAvBuB,CAA1B","file":"shared-strings.js","sourcesContent":["/**\r\n * Copyright (c) 2015-2017 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar SharedStrings = module.exports = function() {\r\n  this._values = [];\r\n  this._totalRefs = 0;\r\n  this._hash = {};\r\n};\r\n\r\nSharedStrings.prototype = {\r\n  get count() {\r\n    return this._values.length;\r\n  },\r\n  get values() {\r\n    return this._values;\r\n  },\r\n  get totalRefs() {\r\n    return this._totalRefs;\r\n  },\r\n\r\n  getString: function(index) {\r\n    return this._values[index];\r\n  },\r\n\r\n  add: function(value) {\r\n    var index = this._hash[value];\r\n    if (index === undefined) {\r\n      index = this._hash[value] = this._values.length;\r\n      this._values.push(value);\r\n    }\r\n    this._totalRefs++;\r\n    return index;\r\n  }\r\n};\r\n"]}