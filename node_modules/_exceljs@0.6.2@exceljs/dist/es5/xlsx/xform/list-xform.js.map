{"version":3,"sources":["../../../../lib/xlsx/xform/list-xform.js"],"names":["utils","require","BaseXform","ListXform","module","exports","options","tag","count","empty","$count","$","childXform","inherits","prepare","model","forEach","childModel","render","xmlStream","length","openNode","addAttribute","closeNode","leafNode","parseOpen","node","parser","name","parseText","text","parseClose","push","undefined","reconcile"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,mBAAR,CAAZ;AACA,IAAIC,YAAYD,QAAQ,cAAR,CAAhB;;AAEA,IAAIE,YAAYC,OAAOC,OAAP,GAAiB,UAASC,OAAT,EAAkB;AACjD,OAAKC,GAAL,GAAWD,QAAQC,GAAnB;AACA,OAAKC,KAAL,GAAaF,QAAQE,KAArB;AACA,OAAKC,KAAL,GAAaH,QAAQG,KAArB;AACA,OAAKC,MAAL,GAAcJ,QAAQI,MAAR,IAAkB,OAAhC;AACA,OAAKC,CAAL,GAASL,QAAQK,CAAjB;AACA,OAAKC,UAAL,GAAkBN,QAAQM,UAA1B;AACD,CAPD;;AASAZ,MAAMa,QAAN,CAAeV,SAAf,EAA0BD,SAA1B,EAAqC;AACnCY,WAAS,iBAASC,KAAT,EAAgBT,OAAhB,EAAyB;AAChC,QAAIM,aAAa,KAAKA,UAAtB;AACA,QAAIG,KAAJ,EAAW;AACTA,YAAMC,OAAN,CAAc,UAASC,UAAT,EAAqB;AACjCL,mBAAWE,OAAX,CAAmBG,UAAnB,EAA+BX,OAA/B;AACD,OAFD;AAGD;AACF,GARkC;;AAUnCY,UAAQ,gBAASC,SAAT,EAAoBJ,KAApB,EAA2B;AACjC,QAAIA,SAASA,MAAMK,MAAnB,EAA2B;AACzBD,gBAAUE,QAAV,CAAmB,KAAKd,GAAxB,EAA6B,KAAKI,CAAlC;AACA,UAAI,KAAKH,KAAT,EAAgB;AACdW,kBAAUG,YAAV,CAAuB,KAAKZ,MAA5B,EAAoCK,MAAMK,MAA1C;AACD;;AAED,UAAIR,aAAa,KAAKA,UAAtB;AACAG,YAAMC,OAAN,CAAc,UAASC,UAAT,EAAqB;AACjCL,mBAAWM,MAAX,CAAkBC,SAAlB,EAA6BF,UAA7B;AACD,OAFD;;AAIAE,gBAAUI,SAAV;AACD,KAZD,MAYO,IAAI,KAAKd,KAAT,EAAgB;AACrBU,gBAAUK,QAAV,CAAmB,KAAKjB,GAAxB;AACD;AACF,GA1BkC;;AA4BnCkB,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAI,KAAKC,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,aAAO,IAAP;AACD;AACD,YAAQA,KAAKE,IAAb;AACE,WAAK,KAAKrB,GAAV;AACE,aAAKQ,KAAL,GAAa,EAAb;AACA,eAAO,IAAP;AACF;AACE,YAAI,KAAKH,UAAL,CAAgBa,SAAhB,CAA0BC,IAA1B,CAAJ,EAAqC;AACnC,eAAKC,MAAL,GAAc,KAAKf,UAAnB;AACA,iBAAO,IAAP;AACD;AACD,eAAO,KAAP;AATJ;AAWD,GA5CkC;AA6CnCiB,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAI,KAAKH,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYE,SAAZ,CAAsBC,IAAtB;AACD;AACF,GAjDkC;AAkDnCC,cAAY,oBAASH,IAAT,EAAe;AACzB,QAAI,KAAKD,MAAT,EAAiB;AACf,UAAI,CAAC,KAAKA,MAAL,CAAYI,UAAZ,CAAuBH,IAAvB,CAAL,EAAmC;AACjC,aAAKb,KAAL,CAAWiB,IAAX,CAAgB,KAAKL,MAAL,CAAYZ,KAA5B;AACA,aAAKY,MAAL,GAAcM,SAAd;AACD;AACD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GA3DkC;AA4DnCC,aAAW,mBAASnB,KAAT,EAAgBT,OAAhB,EAAyB;AAClC,QAAIS,KAAJ,EAAW;AACT,UAAIH,aAAa,KAAKA,UAAtB;AACAG,YAAMC,OAAN,CAAc,UAASC,UAAT,EAAqB;AACjCL,mBAAWsB,SAAX,CAAqBjB,UAArB,EAAiCX,OAAjC;AACD,OAFD;AAGD;AACF;AAnEkC,CAArC","file":"list-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2016 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar utils = require('../../utils/utils');\r\nvar BaseXform = require('./base-xform');\r\n\r\nvar ListXform = module.exports = function(options) {\r\n  this.tag = options.tag;\r\n  this.count = options.count;\r\n  this.empty = options.empty;\r\n  this.$count = options.$count || 'count';\r\n  this.$ = options.$;\r\n  this.childXform = options.childXform;\r\n};\r\n\r\nutils.inherits(ListXform, BaseXform, {\r\n  prepare: function(model, options) {\r\n    var childXform = this.childXform;\r\n    if (model) {\r\n      model.forEach(function(childModel) {\r\n        childXform.prepare(childModel, options);\r\n      });\r\n    }\r\n  },\r\n  \r\n  render: function(xmlStream, model) {\r\n    if (model && model.length) {\r\n      xmlStream.openNode(this.tag, this.$);\r\n      if (this.count) {\r\n        xmlStream.addAttribute(this.$count, model.length);\r\n      }\r\n\r\n      var childXform = this.childXform;\r\n      model.forEach(function(childModel) {\r\n        childXform.render(xmlStream, childModel);\r\n      });\r\n\r\n      xmlStream.closeNode();\r\n    } else if (this.empty) {\r\n      xmlStream.leafNode(this.tag);\r\n    }\r\n  },\r\n\r\n  parseOpen: function(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = [];\r\n        return true;\r\n      default:\r\n        if (this.childXform.parseOpen(node)) {\r\n          this.parser = this.childXform;\r\n          return true;\r\n        }\r\n        return false;\r\n    }\r\n  },\r\n  parseText: function(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  },\r\n  parseClose: function(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.model.push(this.parser.model);\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  reconcile: function(model, options) {\r\n    if (model) {\r\n      var childXform = this.childXform;\r\n      model.forEach(function(childModel) {\r\n        childXform.reconcile(childModel, options);\r\n      });\r\n    }\r\n  }\r\n});\r\n"]}