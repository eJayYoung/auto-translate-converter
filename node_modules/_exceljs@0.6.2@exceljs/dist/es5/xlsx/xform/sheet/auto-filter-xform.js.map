{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/auto-filter-xform.js"],"names":["utils","require","colCache","BaseXform","AutoFilterXform","module","exports","inherits","tag","render","xmlStream","model","leafNode","ref","getAddress","addr","row","column","address","firstAddress","from","secondAddress","to","parseOpen","node","name","attributes"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,WAAWD,QAAQ,0BAAR,CAAf;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,IAAIG,kBAAkBC,OAAOC,OAAP,GAAiB,YAAW,CACjD,CADD;;AAGAN,MAAMO,QAAN,CAAeH,eAAf,EAAgCD,SAAhC,EAA2C;;AAEzC,MAAIK,GAAJ,GAAU;AAAE,WAAO,YAAP;AAAsB,GAFO;;AAIzCC,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAD,kBAAUE,QAAV,CAAmB,YAAnB,EAAiC,EAACC,KAAKF,KAAN,EAAjC;AACD,OAHD,MAGO;AACL,YAAIG,aAAa,SAAbA,UAAa,CAASC,IAAT,EAAe;AAC9B,cAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5B,mBAAOA,IAAP;AACD;AACD,iBAAOb,SAASY,UAAT,CAAoBC,KAAKC,GAAzB,EAA8BD,KAAKE,MAAnC,EAA2CC,OAAlD;AACD,SALD;;AAOA,YAAIC,eAAeL,WAAWH,MAAMS,IAAjB,CAAnB;AACA,YAAIC,gBAAgBP,WAAWH,MAAMW,EAAjB,CAApB;AACA,YAAIH,gBAAgBE,aAApB,EAAmC;AACjCX,oBAAUE,QAAV,CAAmB,YAAnB,EAAiC,EAACC,KAAKM,eAAe,GAAf,GAAqBE,aAA3B,EAAjC;AACD;AACF;AACF;AACF,GAxBwC;;AA0BzCE,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAIA,KAAKC,IAAL,KAAc,YAAlB,EAAgC;AAC9B,WAAKd,KAAL,GAAaa,KAAKE,UAAL,CAAgBb,GAA7B;AACD;AACF;AA9BwC,CAA3C","file":"auto-filter-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2015 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar utils = require('../../../utils/utils');\r\nvar colCache = require('../../../utils/col-cache');\r\nvar BaseXform = require('../base-xform');\r\n\r\nvar AutoFilterXform = module.exports = function() {\r\n};\r\n\r\nutils.inherits(AutoFilterXform, BaseXform, {\r\n\r\n  get tag() { return 'autoFilter'; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      if (typeof model === 'string') {\r\n        // assume range\r\n        xmlStream.leafNode('autoFilter', {ref: model});\r\n      } else {\r\n        var getAddress = function(addr) {\r\n          if (typeof addr === 'string') {\r\n            return addr;\r\n          }\r\n          return colCache.getAddress(addr.row, addr.column).address;\r\n        };\r\n\r\n        var firstAddress = getAddress(model.from);\r\n        var secondAddress = getAddress(model.to);\r\n        if (firstAddress && secondAddress) {\r\n          xmlStream.leafNode('autoFilter', {ref: firstAddress + ':' + secondAddress});\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  parseOpen: function(node) {\r\n    if (node.name === 'autoFilter') {\r\n      this.model = node.attributes.ref;\r\n    }\r\n  }\r\n});\r\n"]}