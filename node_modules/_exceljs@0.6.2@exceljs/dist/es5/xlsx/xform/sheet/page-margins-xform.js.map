{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/page-margins-xform.js"],"names":["_","require","utils","BaseXform","PageMarginsXform","module","exports","inherits","tag","render","xmlStream","model","attributes","left","right","top","bottom","header","footer","some","value","undefined","leafNode","parseOpen","node","name","parseFloat","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,IAAIC,QAAQ,2BAAR,CAAR;AACA,IAAIC,QAAQD,QAAQ,sBAAR,CAAZ;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,IAAIG,mBAAmBC,OAAOC,OAAP,GAAiB,YAAW,CAClD,CADD;;AAGAJ,MAAMK,QAAN,CAAeH,gBAAf,EAAiCD,SAAjC,EAA4C;;AAE1C,MAAIK,GAAJ,GAAU;AAAE,WAAO,aAAP;AAAuB,GAFO;;AAI1CC,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAIC,aAAa;AACfC,cAAMF,MAAME,IADG;AAEfC,eAAOH,MAAMG,KAFE;AAGfC,aAAKJ,MAAMI,GAHI;AAIfC,gBAAQL,MAAMK,MAJC;AAKfC,gBAAQN,MAAMM,MALC;AAMfC,gBAAQP,MAAMO;AANC,OAAjB;AAQA,UAAIlB,EAAEmB,IAAF,CAAOP,UAAP,EAAmB,UAASQ,KAAT,EAAgB;AAAE,eAAOA,UAAUC,SAAjB;AAA6B,OAAlE,CAAJ,EAAyE;AACvEX,kBAAUY,QAAV,CAAmB,KAAKd,GAAxB,EAA6BI,UAA7B;AACD;AACF;AACF,GAlByC;;AAoB1CW,aAAW,mBAASC,IAAT,EAAe;AACxB,YAAQA,KAAKC,IAAb;AACE,WAAK,KAAKjB,GAAV;AACE,aAAKG,KAAL,GAAa;AACXE,gBAAMa,WAAWF,KAAKZ,UAAL,CAAgBC,IAAhB,IAAwB,GAAnC,CADK;AAEXC,iBAAOY,WAAWF,KAAKZ,UAAL,CAAgBE,KAAhB,IAAyB,GAApC,CAFI;AAGXC,eAAKW,WAAWF,KAAKZ,UAAL,CAAgBG,GAAhB,IAAuB,IAAlC,CAHM;AAIXC,kBAAQU,WAAWF,KAAKZ,UAAL,CAAgBI,MAAhB,IAA0B,IAArC,CAJG;AAKXC,kBAAQS,WAAWF,KAAKZ,UAAL,CAAgBK,MAAhB,IAA0B,GAArC,CALG;AAMXC,kBAAQQ,WAAWF,KAAKZ,UAAL,CAAgBM,MAAhB,IAA0B,GAArC;AANG,SAAb;AAQA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AAZJ;AAcD,GAnCyC;AAoC1CS,aAAW,qBAAW,CACrB,CArCyC;AAsC1CC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAxCyC,CAA5C","file":"page-margins-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2016 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar _ = require('../../../utils/under-dash');\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\n\r\nvar PageMarginsXform = module.exports = function() {\r\n};\r\n\r\nutils.inherits(PageMarginsXform, BaseXform, {\r\n\r\n  get tag() { return 'pageMargins'; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      var attributes = {\r\n        left: model.left,\r\n        right: model.right,\r\n        top: model.top,\r\n        bottom: model.bottom,\r\n        header: model.header,\r\n        footer: model.footer\r\n      };\r\n      if (_.some(attributes, function(value) { return value !== undefined; })) {\r\n        xmlStream.leafNode(this.tag, attributes);\r\n      }\r\n    }\r\n  },\r\n  \r\n  parseOpen: function(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          left: parseFloat(node.attributes.left || 0.7),\r\n          right: parseFloat(node.attributes.right || 0.7),\r\n          top: parseFloat(node.attributes.top || 0.75),\r\n          bottom: parseFloat(node.attributes.bottom || 0.75),\r\n          header: parseFloat(node.attributes.header || 0.3),\r\n          footer: parseFloat(node.attributes.footer || 0.3)\r\n        };\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  },\r\n  parseText: function() {\r\n  },\r\n  parseClose: function() {\r\n    return false;\r\n  }\r\n});\r\n"]}