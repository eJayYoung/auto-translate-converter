{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/page-setup-xform.js"],"names":["_","require","utils","BaseXform","booleanToXml","model","undefined","pageOrderToXml","cellCommentsToXml","errorsToXml","pageSizeToModel","value","parseInt","PageSetupXform","module","exports","inherits","tag","render","xmlStream","attributes","paperSize","orientation","horizontalDpi","verticalDpi","pageOrder","blackAndWhite","draft","cellComments","errors","scale","fitToWidth","fitToHeight","firstPageNumber","useFirstPageNumber","usePrinterDefaults","copies","some","leafNode","parseOpen","node","name","parseText","parseClose"],"mappings":"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","file":"page-setup-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2016 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar _ = require('../../../utils/under-dash');\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\n\r\nfunction booleanToXml(model) {\r\n  return model ? '1' : undefined;\r\n}\r\nfunction pageOrderToXml(model) {\r\n  switch (model) {\r\n    case 'overThenDown':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction cellCommentsToXml(model) {\r\n  switch (model) {\r\n    case 'atEnd':\r\n    case 'asDisplyed':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction errorsToXml(model) {\r\n  switch (model) {\r\n    case 'dash':\r\n    case 'blank':\r\n    case 'NA':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction pageSizeToModel(value) {\r\n  return value !== undefined ? parseInt(value, 10) : undefined;\r\n}\r\n\r\nvar PageSetupXform = module.exports = function() {\r\n};\r\n\r\nutils.inherits(PageSetupXform, BaseXform, {\r\n\r\n  get tag() { return 'pageSetup'; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      var attributes = {\r\n        paperSize: model.paperSize,\r\n        orientation: model.orientation,\r\n        horizontalDpi: model.horizontalDpi,\r\n        verticalDpi: model.verticalDpi,\r\n        pageOrder: pageOrderToXml(model.pageOrder),\r\n        blackAndWhite: booleanToXml(model.blackAndWhite),\r\n        draft: booleanToXml(model.draft),\r\n        cellComments: cellCommentsToXml(model.cellComments),\r\n        errors: errorsToXml(model.errors),\r\n        scale: model.scale,\r\n        fitToWidth: model.fitToWidth,\r\n        fitToHeight: model.fitToHeight,\r\n        firstPageNumber: model.firstPageNumber,\r\n        useFirstPageNumber: booleanToXml(model.firstPageNumber),\r\n        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),\r\n        copies: model.copies\r\n      };\r\n      if (_.some(attributes, function(value) {\r\n          return value !== undefined;\r\n        })) {\r\n        xmlStream.leafNode(this.tag, attributes);\r\n      }\r\n    }\r\n  },\r\n  \r\n  parseOpen: function(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          paperSize: pageSizeToModel(node.attributes.paperSize),\r\n          orientation: node.attributes.orientation || 'portrait',\r\n          horizontalDpi: parseInt(node.attributes.horizontalDpi || '4294967295', 10),\r\n          verticalDpi: parseInt(node.attributes.verticalDpi || '4294967295', 10),\r\n          pageOrder: node.attributes.pageOrder || 'downThenOver',\r\n          blackAndWhite: node.attributes.blackAndWhite === '1',\r\n          draft: node.attributes.draft === '1',\r\n          cellComments: node.attributes.cellComments || 'None',\r\n          errors: node.attributes.errors || 'displayed',\r\n          scale: parseInt(node.attributes.scale || '100', 10),\r\n          fitToWidth: parseInt(node.attributes.fitToWidth || '1', 10),\r\n          fitToHeight: parseInt(node.attributes.fitToHeight || '1', 10),\r\n          firstPageNumber: parseInt(node.attributes.firstPageNumber || '1', 10),\r\n          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',\r\n          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',\r\n          copies: parseInt(node.attributes.copies || '1', 10)\r\n        };\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  },\r\n  parseText: function() {\r\n  },\r\n  parseClose: function() {\r\n    return false;\r\n  }\r\n});\r\n"]}