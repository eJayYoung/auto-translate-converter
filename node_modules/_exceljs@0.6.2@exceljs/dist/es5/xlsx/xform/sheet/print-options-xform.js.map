{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/print-options-xform.js"],"names":["_","require","utils","BaseXform","booleanToXml","model","undefined","PrintOptionsXform","module","exports","inherits","tag","render","xmlStream","attributes","headings","showRowColHeaders","gridLines","showGridLines","horizontalCentered","verticalCentered","some","value","leafNode","parseOpen","node","name","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,IAAIC,QAAQ,2BAAR,CAAR;AACA,IAAIC,QAAQD,QAAQ,sBAAR,CAAZ;AACA,IAAIE,YAAYF,QAAQ,eAAR,CAAhB;;AAEA,SAASG,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,SAAOA,QAAQ,GAAR,GAAcC,SAArB;AACD;;AAED,IAAIC,oBAAoBC,OAAOC,OAAP,GAAiB,YAAW,CACnD,CADD;;AAGAP,MAAMQ,QAAN,CAAeH,iBAAf,EAAkCJ,SAAlC,EAA6C;;AAE3C,MAAIQ,GAAJ,GAAU;AAAE,WAAO,cAAP;AAAwB,GAFO;;AAI3CC,UAAQ,gBAASC,SAAT,EAAoBR,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACT,UAAIS,aAAa;AACfC,kBAAUX,aAAaC,MAAMW,iBAAnB,CADK;AAEfC,mBAAWb,aAAaC,MAAMa,aAAnB,CAFI;AAGfC,4BAAoBf,aAAaC,MAAMc,kBAAnB,CAHL;AAIfC,0BAAkBhB,aAAaC,MAAMe,gBAAnB;AAJH,OAAjB;AAMA,UAAIpB,EAAEqB,IAAF,CAAOP,UAAP,EAAmB,UAASQ,KAAT,EAAgB;AACnC,eAAOA,UAAUhB,SAAjB;AACD,OAFC,CAAJ,EAEM;AACJO,kBAAUU,QAAV,CAAmB,KAAKZ,GAAxB,EAA6BG,UAA7B;AACD;AACF;AACF,GAlB0C;;AAoB3CU,aAAW,mBAASC,IAAT,EAAe;AACxB,YAAQA,KAAKC,IAAb;AACE,WAAK,KAAKf,GAAV;AACE,aAAKN,KAAL,GAAa;AACXW,6BAAmBS,KAAKX,UAAL,CAAgBC,QAAhB,KAA6B,GADrC;AAEXG,yBAAeO,KAAKX,UAAL,CAAgBG,SAAhB,KAA8B,GAFlC;AAGXE,8BAAoBM,KAAKX,UAAL,CAAgBK,kBAAhB,KAAuC,GAHhD;AAIXC,4BAAkBK,KAAKX,UAAL,CAAgBM,gBAAhB,KAAqC;AAJ5C,SAAb;AAMA,eAAO,IAAP;AACF;AACE,eAAO,KAAP;AAVJ;AAYD,GAjC0C;AAkC3CO,aAAW,qBAAW,CACrB,CAnC0C;AAoC3CC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AAtC0C,CAA7C","file":"print-options-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2016 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar _ = require('../../../utils/under-dash');\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\n\r\nfunction booleanToXml(model) {\r\n  return model ? '1' : undefined;\r\n}\r\n\r\nvar PrintOptionsXform = module.exports = function() {\r\n};\r\n\r\nutils.inherits(PrintOptionsXform, BaseXform, {\r\n\r\n  get tag() { return 'printOptions'; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      var attributes = {\r\n        headings: booleanToXml(model.showRowColHeaders),\r\n        gridLines: booleanToXml(model.showGridLines),\r\n        horizontalCentered: booleanToXml(model.horizontalCentered),\r\n        verticalCentered: booleanToXml(model.verticalCentered)\r\n      };\r\n      if (_.some(attributes, function(value) {\r\n          return value !== undefined;\r\n        })) {\r\n        xmlStream.leafNode(this.tag, attributes);\r\n      }\r\n    }\r\n  },\r\n  \r\n  parseOpen: function(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          showRowColHeaders: node.attributes.headings === '1',\r\n          showGridLines: node.attributes.gridLines === '1',\r\n          horizontalCentered: node.attributes.horizontalCentered === '1',\r\n          verticalCentered: node.attributes.verticalCentered === '1'\r\n        };\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  },\r\n  parseText: function() {\r\n  },\r\n  parseClose: function() {\r\n    return false;\r\n  }\r\n});\r\n"]}