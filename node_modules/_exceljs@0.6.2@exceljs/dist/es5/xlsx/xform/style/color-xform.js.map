{"version":3,"sources":["../../../../../lib/xlsx/xform/style/color-xform.js"],"names":["utils","require","BaseXform","ColorXform","module","exports","name","inherits","tag","render","xmlStream","model","openNode","argb","addAttribute","theme","undefined","tint","indexed","closeNode","parseOpen","node","attributes","rgb","parseInt","parseFloat","parseText","parseClose"],"mappings":"AAAA;;;;;;AAMA;;AAEA,IAAIA,QAAQC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,YAAYD,QAAQ,eAAR,CAAhB;;AAEA;AACA,IAAIE,aAAaC,OAAOC,OAAP,GAAiB,UAASC,IAAT,EAAe;AAC/C;AACA,OAAKA,IAAL,GAAYA,QAAQ,OAApB;AACD,CAHD;;AAKAN,MAAMO,QAAN,CAAeJ,UAAf,EAA2BD,SAA3B,EAAsC;;AAEpC,MAAIM,GAAJ,GAAU;AAAE,WAAO,KAAKF,IAAZ;AAAmB,GAFK;;AAIpCG,UAAQ,gBAASC,SAAT,EAAoBC,KAApB,EAA2B;AACjC,QAAIA,KAAJ,EAAW;AACTD,gBAAUE,QAAV,CAAmB,KAAKN,IAAxB;AACA,UAAIK,MAAME,IAAV,EAAgB;AACdH,kBAAUI,YAAV,CAAuB,KAAvB,EAA8BH,MAAME,IAApC;AACD,OAFD,MAEO,IAAIF,MAAMI,KAAN,KAAgBC,SAApB,EAA+B;AACpCN,kBAAUI,YAAV,CAAuB,OAAvB,EAAgCH,MAAMI,KAAtC;AACA,YAAIJ,MAAMM,IAAN,KAAeD,SAAnB,EAA8B;AAC5BN,oBAAUI,YAAV,CAAuB,MAAvB,EAA+BH,MAAMM,IAArC;AACD;AACF,OALM,MAKA,IAAIN,MAAMO,OAAN,KAAkBF,SAAtB,EAAiC;AACtCN,kBAAUI,YAAV,CAAuB,SAAvB,EAAkCH,MAAMO,OAAxC;AACD,OAFM,MAEA;AACLR,kBAAUI,YAAV,CAAuB,MAAvB,EAA+B,GAA/B;AACD;AACDJ,gBAAUS,SAAV;AACA,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GAvBmC;;AAyBpCC,aAAW,mBAASC,IAAT,EAAe;AACxB,QAAIA,KAAKf,IAAL,KAAc,KAAKA,IAAvB,EAA6B;AAC3B,UAAIe,KAAKC,UAAL,CAAgBC,GAApB,EAAyB;AACvB,aAAKZ,KAAL,GAAa,EAACE,MAAMQ,KAAKC,UAAL,CAAgBC,GAAvB,EAAb;AACD,OAFD,MAEO,IAAIF,KAAKC,UAAL,CAAgBP,KAApB,EAA2B;AAChC,aAAKJ,KAAL,GAAa,EAACI,OAAOS,SAASH,KAAKC,UAAL,CAAgBP,KAAzB,EAAgC,EAAhC,CAAR,EAAb;AACA,YAAIM,KAAKC,UAAL,CAAgBL,IAApB,EAA0B;AACxB,eAAKN,KAAL,CAAWM,IAAX,GAAkBQ,WAAWJ,KAAKC,UAAL,CAAgBL,IAA3B,CAAlB;AACD;AACF,OALM,MAKA,IAAII,KAAKC,UAAL,CAAgBJ,OAApB,EAA6B;AAClC,aAAKP,KAAL,GAAa,EAACO,SAASM,SAASH,KAAKC,UAAL,CAAgBJ,OAAzB,EAAkC,EAAlC,CAAV,EAAb;AACD,OAFM,MAEA;AACL,aAAKP,KAAL,GAAaK,SAAb;AACD;AACD,aAAO,IAAP;AACD;AACD,WAAO,KAAP;AACD,GA1CmC;AA2CpCU,aAAW,qBAAW,CACrB,CA5CmC;AA6CpCC,cAAY,sBAAW;AACrB,WAAO,KAAP;AACD;AA/CmC,CAAtC","file":"color-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2015 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\n\r\n// Color encapsulates translation from color model to/from xlsx\r\nvar ColorXform = module.exports = function(name) {\r\n  // this.name controls the xm node name\r\n  this.name = name || 'color';\r\n};\r\n\r\nutils.inherits(ColorXform, BaseXform, {\r\n\r\n  get tag() { return this.name; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      xmlStream.openNode(this.name);\r\n      if (model.argb) {\r\n        xmlStream.addAttribute('rgb', model.argb);\r\n      } else if (model.theme !== undefined) {\r\n        xmlStream.addAttribute('theme', model.theme);\r\n        if (model.tint !== undefined) {\r\n          xmlStream.addAttribute('tint', model.tint);\r\n        }\r\n      } else if (model.indexed !== undefined) {\r\n        xmlStream.addAttribute('indexed', model.indexed);\r\n      } else {\r\n        xmlStream.addAttribute('auto', '1');\r\n      }\r\n      xmlStream.closeNode();\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  \r\n  parseOpen: function(node) {\r\n    if (node.name === this.name) {\r\n      if (node.attributes.rgb) {\r\n        this.model = {argb: node.attributes.rgb};\r\n      } else if (node.attributes.theme) {\r\n        this.model = {theme: parseInt(node.attributes.theme, 10)};\r\n        if (node.attributes.tint) {\r\n          this.model.tint = parseFloat(node.attributes.tint);\r\n        }\r\n      } else if (node.attributes.indexed) {\r\n        this.model = {indexed: parseInt(node.attributes.indexed, 10)};\r\n      } else {\r\n        this.model = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  parseText: function() {\r\n  },\r\n  parseClose: function() {\r\n    return false;\r\n  }\r\n});\r\n"]}